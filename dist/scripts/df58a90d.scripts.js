"use strict";angular.module("newSomEnergiaWebformsApp",["ngCookies","ngResource","ngSanitize","ngRoute","pascalprecht.translate"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/:locale",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]).config(["$translateProvider",function(a){a.translations("es",{SELECCIONA:"Selecciona",SELECCIONA_PARTICULAR:"Particular",SELECCIONA_EMPRESA:"Empresa",OBLIGATORI:"Obligatorio",IDIOMA:"Idioma",SELECCIONA_IDIOMA:"Selecciona idioma",RAO_SOCIAL:"Razón social",PERSONA_REPRESENTANT:"Persona representante",REPETEIX_EMAIL:"Repetir email",TELEFON:"Teléfono",ADRECA:"Dirección",CODI_POSTAL:"Código postal",PROVINCIA:"Província",POBLACIO:"Población",ACCEPTO_POLITICA_PRIVACITAT:'Acepto la <strong><a target="_blank" href="#">política de privacidad</a></strong> de Som Energia',METODE_PAGAMENT:"Forma de pago",REBUT_BANCARI:"Recibo bancario",TARGETA_CREDIT:"Tarjeta de crédito",COST:"Coste para la cooperativa",INFO_APORTACIO:"La aportación para ser socio/a son 100€<br/>Los 100€ se pagan una sola vez, no hay cuota anual y son retornables si te das de baja.",FINALITZA_PROCES:"Finaliza el proceso",FORMULARI_NO_DISPONIBLE:"Formulario no disponible, disculpen las moléstias."}).translations("ca",{SELECCIONA:"Sel·lecciona",SELECCIONA_PARTICULAR:"Particular",SELECCIONA_EMPRESA:"Empresa",OBLIGATORI:"Obligatori",IDIOMA:"Idioma",SELECCIONA_IDIOMA:"Sel·lecciona idioma",RAO_SOCIAL:"Raó social",PERSONA_REPRESENTANT:"Persona representant",REPETEIX_EMAIL:"Repeteix email",TELEFON:"Telèfon",ADRECA:"Adreça",CODI_POSTAL:"Codi postal",PROVINCIA:"Provincia",POBLACIO:"Població",ACCEPTO_POLITICA_PRIVACITAT:'Accepto la <strong><a target="_blank" href="#">política de privacitat</a></strong> de Som Energia',METODE_PAGAMENT:"Mètode de pagament",REBUT_BANCARI:"Rebut bancari",TARGETA_CREDIT:"Targeta de crèdit",COST:"Cost per a la cooperativa",INFO_APORTACIO:"L'aportació per a esdevenir soci/a són 100€<br/>Els 100€ es paguen una sola vegada, no hi ha quota anual i són retornables si et dones de baixa.",FINALITZA_PROCES:"Finalitza el procés",FORMULARI_NO_DISPONIBLE:"Formulari no disponible, disculpeu les molèsties."}).preferredLanguage("ca")}]).constant("cfg",{API_BASE_URL:"http://somenergia-api-webforms.gisce.net/",STATUS_OFFLINE:"OFFLINE",STATUS_ONLINE:"ONLINE",STATE_TRUE:!0,STATE_FALSE:!1}),angular.module("newSomEnergiaWebformsApp").controller("MainCtrl",["cfg","$scope","$http","$routeParams","$translate","$log",function(a,b,c,d,e,f){c.get(a.API_BASE_URL+"data/provincies").success(function(c){c.status===a.STATUS_ONLINE?c.state===a.STATE_TRUE?b.provinces=c.data.provincies:(f.error("data/provinces error response recived",c),b.showErrorDialog("GET provincies return false state")):b.showErrorDialog(c.status===a.STATUS_OFFLINE?"API server status offline":"API server unknown status")}),c.get(a.API_BASE_URL+"data/idiomes").success(function(c){c.status===a.STATUS_ONLINE?c.state===a.STATE_TRUE?b.languages=c.data.idiomes:(f.log("data/idiomes error response recived",c),b.showErrorDialog("GET idiomes return false state")):b.showErrorDialog(c.status===a.STATUS_OFFLINE?"API server status offline":"API server unknown status")}),b.currentStep=1,b.submitReady=!1,b.submitted=!1,b.languages=[],b.provinces=[],b.cities=[],b.language={},b.province={},b.city={},void 0!==d.locale&&e.use(d.locale),b.updateSelectedCity=function(){c.get(a.API_BASE_URL+"data/municipis/"+b.province.id).success(function(c){c.status===a.STATUS_ONLINE?c.state===a.STATE_TRUE?b.cities=c.data.municipis:(f.log("data/municipis/"+b.province.id+" response recived",c),b.showErrorDialog("GET municipis return false state")):b.showErrorDialog(c.status===a.STATUS_OFFLINE?"API server status offline":"API server unknown status")})},b.submit=function(a){return b.submitted=!0,a.$invalid?null:!0},b.showErrorDialog=function(a){b.errorMsg=a,jQuery("#api-server-offline-modal").modal({keyboard:!1,show:!0})}}]);